{"version":3,"sources":["customer.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"customer.js","sourcesContent":["$(document).ready(function(){\n    $('#make_name').focusout(function(){\n        $('.project-info .make-name').text($(this).val());\n    });\n});\n\nfunction goto_make(hrefMake) {\n    var makeName = $('#make_name').val(); \n    if(makeName == ''){\n        $('#modal-confirm-name').modal('show');\n    }else{\n        $.cookie(\"makeName\", makeName, { expires: 7 }); \n        location.href = hrefMake;\n    }\n}\n\nfunction hideModalConfirmMake(){\n    $('#modal-confirm-make').hide();\n}\n\nfunction goToFinish(){\n    location.href = \"/css/cancel\";\n}\n\n/**\n * Trang lam danh gia\n * Khi khach hang danh danh gia mot tieu chi\n * Tinh tong diem realtime\n * @returns void\n */\nfunction totalMark(elem) { \n    var point = $(elem).rateit('value');  \n    var dataQuestionid = $(elem).attr('data-questionid');\n    var commentElem = $(\".comment-question[data-questionid='\"+dataQuestionid+\"']\");\n    if(point < 3){\n        var text = commentElem.val();\n        if($.trim(text) === ''){\n            commentElem.css(\"border\",\"1px solid red\");\n            commentElem.attr('placeholder','＃コメントがあればご記入ください');\n        }\n    }else{\n        commentElem.css(\"border\",\"1px solid #d2d6de\");\n        commentElem.removeAttr('placeholder');\n    }\n    \n    if(elem.id === 'tongquat'){\n        $(elem).css(\"border\",\"1px solid #d2d6de\");\n    }\n    \n    $(\"#total-point\").html(getTotalPoint());\n    $(\".point-fixed\").html(getTotalPoint());\n}\n\n/**\n * Get total point\n * @returns {Number}\n */\nfunction getTotalPoint(){\n    var tongSoCauDanhGia = 0;\n    var total = 0;\n    $(\".rateit\").each(function(){\n        var danhGia = parseInt($(this).rateit('value'));\n        if($(this).attr(\"id\") !== \"tongquat\"){\n            if(danhGia > 0){\n                tongSoCauDanhGia++;\n                total += danhGia;\n            }\n        }\n    });\n    \n    var diemTongQuat = parseInt($(\"#tongquat\").rateit('value'));\n    if(tongSoCauDanhGia === 0){\n        total = diemTongQuat * 20;\n    }else{\n        total = diemTongQuat * 4 + total/(tongSoCauDanhGia * 5) * 80;\n    }\n    \n    return total.toFixed(2);\n}\n\n/**\n * show or hide total point at bottom right make css page\n */\n$(window).scroll(function(){\n    if($('.visible-check').visible()){\n        $(\".point-fixed\").hide();\n    } else {\n        $(\".point-fixed\").show();\n    }\n});\n\n/**\n * Function confirm CSS\n * @returns void\n */\nfunction confirm(arrayValidate){\n    var invalid = false;\n    var strInvalid = \"\";\n    $('#modal-confirm').modal('hide');\n    $(\".comment-question\").css(\"border-color\",\"#d2d6de\");\n    $(\"#tongquat\").css(\"border\",\"none\");\n    $(\"#comment-tongquat\").css(\"border-color\",\"#d2d6de\");\n    \n    var arrayValidate = $.parseJSON(arrayValidate);\n    \n    var diemTongQuat = parseInt($(\"#tongquat\").rateit('value'));\n    if(diemTongQuat == 0){\n        invalid = true;\n        strInvalid += '<p>'+arrayValidate['totalMarkValidateRequired']+'</p>';\n        $(\"#tongquat\").css(\"border\",\"1px solid red\");\n    }\n    \n    var arrValidate = [];\n    $(\".rateit\").each(function(){\n        var danhGia = parseInt($(this).rateit('value'));\n       \n            if(danhGia > 0 && danhGia < 3){\n                if($(\".comment-question[data-questionid='\"+$(this).attr(\"data-questionid\")+\"']\").val() == \"\"){\n                    arrValidate.push($(this).attr(\"data-questionid\"));\n                }\n            }\n        \n    }); \n    \n    if(arrValidate.length > 0) {\n        for(var i=0; i<arrValidate.length; i++){\n            $(\".comment-question[data-questionid='\"+arrValidate[i]+\"']\").css(\"border\",\"1px solid red\");\n        }\n        strInvalid += '<p>'+arrayValidate['questionCommentRequired']+'</p>';\n        invalid = true;\n    }\n    \n    if(invalid){\n        $('#modal-alert .modal-body').html(strInvalid);\n        $('#modal-alert').modal('show');\n        return false;\n    }\n    \n    $('#modal-confirm .modal-body').html(\"現在の点数は \"+$(\"#total-point\").html()+\" 点です。アンケート結果を送信しますか。\");\n    $('#modal-confirm').modal('show');\n}\n\n/**\n * Validate then insert CSS result into database\n * @param string token\n * @param int cssId\n * @param json arrayValidate\n * @returns void\n */\nfunction submit(token, cssId){ \n    var make_name = $(\".make-name\").text(); \n    var make_email = 'test';\n    var totalMark = getTotalPoint();\n    var proposed = $(\"#proposed\").val();\n    var arrayQuestion = [];\n    $(\".rateit\").each(function(){\n        var danhGia = parseInt($(this).rateit('value'));\n        var questionId = $(this).attr(\"data-questionid\");\n        var diem = danhGia;\n        var comment = $(\".comment-question[data-questionid='\"+$(this).attr(\"data-questionid\")+\"']\").val();\n        arrayQuestion.push([questionId,diem,comment]);\n    });\n    \n    $(\".apply-click-modal\").show(); \n    $.ajax({\n        url: baseUrl + '/css/saveResult',\n        type: 'post',\n        data: {\n            _token: token, \n            arrayQuestion: arrayQuestion, \n            make_name: make_name, \n            make_email: make_email, \n            totalMark: totalMark,\n            proposed: proposed,\n            cssId: cssId\n        },\n    })\n    .done(function (data) { \n        location.href = baseUrl + \"css/success/\"+cssId;\n    })\n    .fail(function () {\n        alert(\"Ajax failed to fetch data\");\n    })\n}"],"sourceRoot":"/source/"}