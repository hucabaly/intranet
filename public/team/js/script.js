jQuery(document).ready(function(t){function a(a){var e=a.data("id");a.is(":checked")?t(".team-group-function[data-id="+e+"]").show():t(".team-group-function[data-id="+e+"]").hide()}t("input.input-is-function").each(function(e,i){a(t(this))}),t("input.input-is-function").on("change",function(e){a(t(this))}),htmlAddTeamPositonOrigin=t(".group-team-position-orgin").html(),t(".group-team-position-orgin").remove(),dataIdLast=jQuery(".box-form-team-position").children(".group-team-position").length,dataIdLast?dataIdLast=parseInt(dataIdLast):dataIdLast=0,1==dataIdLast&&t(".box-form-team-position .group-team-position .input-remove").addClass("warning-action"),t(document).on("click",".input-team-position.input-add-new button",function(a){dataIdLast++,htmlAddTeamPositon=t(htmlAddTeamPositonOrigin),htmlAddTeamPositon.find(".input-team-position.input-team select").attr("name","team["+dataIdLast+"][team]"),htmlAddTeamPositon.find(".input-team-position.input-position select").attr("name","team["+dataIdLast+"][position]"),t(".box-form-team-position").append(htmlAddTeamPositon),t(".box-form-team-position .group-team-position .input-remove").removeClass("warning-action"),1==t(".box-form-team-position").children(".group-team-position").length&&t(".box-form-team-position .group-team-position .input-remove").addClass("warning-action"),t("input[name=employee_team_change]").val(1)}),t(document).on("click",".input-team-position.input-remove",function(a){teamLength=t(".box-form-team-position").children(".group-team-position").length,teamLength>1&&(t(this).parents(".group-team-position").remove(),t("input[name=employee_team_change]").val(1)),2==teamLength&&t(".box-form-team-position .group-team-position .input-remove").addClass("warning-action")}),t(document).on("change",".group-team-position select",function(a){t("input[name=employee_team_change]").val(1)}),t("#employee-role-form").on("hide.bs.modal",function(a){htmlRoleList="",t(this).find(".checkbox input:checked").each(function(a,e){htmlRoleList+="<li><span>",htmlRoleList+=t(this).parent().text().trim(),htmlRoleList+="</li></span>"}),t("ul.employee-roles").html(htmlRoleList),t("input[name=employee_role_change]").val(1)}),lengthTrTableRule=t(".team-rule-wrapper table.table-team-rule tbody tr").length,t(".team-rule-wrapper table.table-team-rule tbody tr:last-child .form-input-dropdown").addClass("input-rule-last"),t(".team-rule-wrapper table.table-team-rule tbody tr:nth-child("+(lengthTrTableRule-1)+") .form-input-dropdown").addClass("input-rule-last");var e=t(".team-rule-wrapper .table-responsive").css("padding-bottom");t(".input-rule-last").on("show.bs.dropdown",function(){t(".team-rule-wrapper .table-responsive").css("padding-bottom","90px")}),t(".input-rule-last").on("hide.bs.dropdown",function(){t(".team-rule-wrapper .table-responsive").css("padding-bottom",e)})}),function(t){t.fn.employeeSkillAction=function(a){function e(a,e,i){e&&void 0!=e||(e=null);var o=a.attr("data-id");o=parseInt(o);var l=a.data("group");return f[l]=1,i&&"delete"==i?(delete m[l][o],t("input[name=employee_skill]").val(t.param(m)),t("input[name=employee_skill_change]").val(t.param(f)),!0):(o||(o=b[l],b[l]++),inputIdCheck=a.find("input[data-col=id]"),flagCheckInputSame=!1,inputIdCheck.length&&inputIdCheck.val()&&(dataTbl=inputIdCheck.data("tbl"),t.each(m[l],function(t,a){return o==t||(a[dataTbl].id==inputIdCheck.val()?(flagCheckInputSame=!0,!1):void 0)})),flagCheckInputSame?(alert(u["same_"+l]),!0):(a.find(".input-skill-modal[data-tbl][data-col]").each(function(a,i){inputType=t(this).attr("type"),dataCol=t(this).data("col"),dataTbl=t(this).data("tbl"),dataCol&&dataTbl&&(valueInput=t(this).val(),void 0==m[l][o]&&(m[l][o]={}),void 0==m[l][o][dataTbl]&&(m[l][o][dataTbl]={}),void 0==m[l][o][dataTbl][dataCol]&&(m[l][o][dataTbl][dataCol]={}),"file"==inputType&&t(this).parents(".input-box-img-preview").length&&(e&&e.image&&e.image_path?(valueInput=e.image,m[l][o][dataTbl].image_path=e.image_path):(valueInput=t(this).parents(".input-box-img-preview").find("img[data-tbl="+dataTbl+"][data-col="+dataCol+"_preview]").attr("src"),m[l][o][dataTbl].image_path="")),m[l][o][dataTbl][dataCol]=valueInput)}),t("input[name=employee_skill]").val(t.param(m)),void t("input[name=employee_skill_change]").val(t.param(f))))}function i(a){skillListWrapper=t(".employee-skill-box-wrapper[data-group="+a+"] .employee-skill-items"),skillListItem0=skillListWrapper.find(".esbw-item[data-id=0]");var e="";t.each(m[a],function(a,i){return 0==a||(skillItemNew=skillListItem0.clone(),skillItemNew.attr("data-id",a),skillItemNew.removeClass("hidden"),skillItemNew.find("[data-tbl][data-col]").each(function(){dataTbl=t(this).data("tbl"),dataCol=t(this).data("col"),t(this).is("img")?skillItemNew.find("[data-tbl="+dataTbl+"][data-col="+dataCol+"]").attr("src",i[dataTbl][dataCol]):(valueInput=i[dataTbl][dataCol],domInput=skillItemNew.find("[data-tbl="+dataTbl+"][data-col="+dataCol+"]"),dataDateFormat=domInput.data("date-format"),dataLabelFormat=domInput.data("label-format"),dataDateFormat?(date=new Date(valueInput),valueInput=getDateFormat(date,dataDateFormat)):dataLabelFormat&&(valueInput=h[dataLabelFormat][valueInput]),domInput.html(valueInput))}),void(e+=skillItemNew[0].outerHTML))}),skillListWrapper.children(":not(.esbw-item)").html(e)}function o(){t(".employee-skill-modal input[data-autocomplete=true]").each(function(){var a=t(this).data("tbl");return void 0==v[a]||!v[a]||(v[a]=JSON.parse(v[a]),void t(this).autocomplete({minLength:0,source:v[a],select:function(e,i){thisParent=t(this).parents(".employee-skill-modal");var o=i.item;thisParent.find(".input-skill-modal[data-tbl="+a+"]:not([data-autocomplete=true])").each(function(){return!!t(this).hasClass("not-auto")||(inputType=t(this).attr("type"),dataCol=t(this).data("col"),void(dataCol&&(value=o[dataCol],"file"==inputType?(t(this).parents(".input-box-img-preview").length&&t(this).parents(".input-box-img-preview").find("img[data-col="+dataCol+"_preview]").attr("src",value),t(this).attr("disabled",!0).val("")):value&&void 0!=value?(value=t.parseHTML(value)[0].nodeValue,t(this).attr("disabled",!0).val(value)):t(this).attr("disabled",!0).val(""))))})}}).focus(function(){t(this).autocomplete("search")}))})}function l(){t.ajax({url:c,type:"POST",data:{_token:r},dataType:"json",success:function(t){v=t,o()}})}t(".employee-skill-modal").on("shown.bs.modal",function(a){idModal=t(this).attr("id"),idModal?idModal="#"+idModal+" ":idModal="",t(this).find(".input-box-img-preview .skill-modal-image").verticalCenter({parent:idModal+".input-box-img-preview .skill-modal-image-preview"})});var n,d,s,p,r,m,u,h,c,v={},f={schools:0},b={};r=t("input[name=_token]").val(),v=a.autoComplete,p=a.imagePreviewImageDefault,b=a.employeeSkillNo,m=a.employeeSkill,u=a.messageError,h=a.labelFormat,c=a.urlLoadAutoComplete,f=a.groupChange,t(document).on("click",".employee-skill-box-wrapper [data-modal=true]",function(a){s=t(this).parents(".esbw-item").data("id"),s&&void 0!=s||(s=0),n=t(this).parents(".employee-skill-box-wrapper").data("group"),d=t(this).parents(".employee-skill-box-wrapper").data("href"),dataIsChange=t(this).parents(".employee-skill-box-wrapper").data("change"),t(d).modal("show"),s?t(d).find(".btn-delete.btn-action").removeClass("hidden"):t(d).find(".btn-delete.btn-action").addClass("hidden"),t(d).on("shown.bs.modal",function(a){t(this).find(".input-skill-modal").removeAttr("disabled").val(""),t(this).find("img.college-image-preview").attr("src",p),t(this).find(".input-skill-modal").each(function(a,e){inputType=t(this).attr("type"),dataCol=t(this).data("col"),dataTbl=t(this).data("tbl"),dataCol&&dataTbl&&(valueId=m[n][s][dataTbl].id,value=m[n][s][dataTbl][dataCol],"file"==inputType?(t(this).parents(".input-box-img-preview").length&&t(this).parents(".input-box-img-preview").find("img[data-tbl="+dataTbl+"][data-col="+dataCol+"_preview]").attr("src",value),valueId&&(t(this).hasClass("not-auto")?t(this).val(""):t(this).attr("disabled",!0).val(""))):(value&&void 0!=value?value=t.parseHTML(value)[0].nodeValue:value="",valueId&&!t(this).data("autocomplete")&&"hidden"!=t(this).attr("type")?t(this).hasClass("not-auto")?t(this).val(value):t(this).attr("disabled",!0).val(value):t(this).val(value),t(this).is("select")&&t(this).val(value).trigger("change")))}),t(this).attr("data-id",s)})}),t(".employee-skill-modal .btn-action.btn-add, .employee-skill-modal .btn-action.btn-edit").on("click",function(a){var o=t(this).parents(".employee-skill-modal"),l=o.data("group");return formDomModal=o.find("form"),!(!formDomModal.length||formDomModal.valid())||void(o.find("input[type=file]").val()?(formDom=o.find("form.skill-modal-form"),formData=new FormData,formData.append("_token",r),formData.append("skill_type",l),formData.append("file",formDom.find("input[type=file]")[0].files[0]),t.ajax({url:formDom.attr("action"),type:"POST",data:formData,dataType:"json",processData:!1,contentType:!1,success:function(t){void 0!=t.error&&t.error?alert(t.error):(e(o,t),i(l)),o.modal("hide")}})):(e(o),i(l),o.modal("hide")))}),t(".employee-skill-modal .btn-action.btn-delete").on("click",function(a){thisDomModal=t(this).parents(".employee-skill-modal"),dataGroupType=thisDomModal.data("group"),dataId=thisDomModal.attr("data-id"),dataId=parseInt(dataId),0!=dataId&&(e(thisDomModal,null,"delete"),i(dataGroupType)),thisDomModal.modal("hide")}),t(".employee-skill-modal").scroll(function(){t("input").blur()}),t(".employee-skill-modal form").on("submit",function(t){t.preventDefault()}),t(".employee-skill-modal").on("hidden.bs.modal",function(a){t(this).find("input").removeAttr("disabled").val(""),t(this).find("img[data-col=image_preview]").attr("src",p)}),t(window).load(function(){l()}),t(".employee-skill-modal input[data-autocomplete=true]").on("keyup",function(a){if(13==a.keyCode);else{thisParent=t(this).parents(".employee-skill-modal");var e=t(this).data("tbl");thisParent.find("input[data-tbl="+e+"]:not([data-autocomplete=true])").each(function(){return inputType=t(this).attr("type"),"file"==inputType?(t(this).removeAttr("disabled"),!0):t(this).hasClass("not-auto")?(t(this).removeAttr("disabled"),!0):"id"==t(this).data("col")?(t(this).removeAttr("disabled").val(""),!0):(t(this).removeAttr("disabled"),!0)})}})}}(jQuery);